<Window x:Class="RevitElementsExporter.ExportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Revit Elements Exporter"
        Width="780"
        Height="700"
        MinWidth="700"
        MinHeight="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize"
        AllowsTransparency="False">
  <Window.Resources>
    <ResourceDictionary>
      <ResourceDictionary.MergedDictionaries>
        <ResourceDictionary Source="Themes/Styles.xaml" />
      </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
  </Window.Resources>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto" />
      <RowDefinition Height="*" />
    </Grid.RowDefinitions>

    <!-- Header Section with Gradient -->
    <Border Grid.Row="0"
            Background="{StaticResource AccentGradientBrush}"
            Padding="24,20">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        
        <StackPanel Grid.Column="0">
          <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
            <Border Background="#33FFFFFF" CornerRadius="8" Padding="8" Margin="0,0,12,0">
              <Path Data="M19,3H5C3.89,3 3,3.89 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5C21,3.89 20.1,3 19,3M9,17H7V10H9V17M13,17H11V7H13V17M17,17H15V13H17V17Z"
                    Fill="White"
                    Width="24" Height="24"
                    Stretch="Uniform" />
            </Border>
            <StackPanel VerticalAlignment="Center">
              <TextBlock Text="Revit Elements Exporter"
                         FontSize="20"
                         FontWeight="Bold"
                         Foreground="White"
                         Margin="0" />
            </StackPanel>
          </StackPanel>
          <TextBlock Text="à¸ªà¹ˆà¸‡à¸­à¸­à¸à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ elements à¸žà¸£à¹‰à¸­à¸¡à¸žà¸´à¸à¸±à¸”à¹à¸¥à¸° metadata à¸ˆà¸²à¸ Revit"
                     FontSize="13"
                     Foreground="#CCFFFFFF"
                     Margin="0" />
        </StackPanel>

        <!-- Theme Toggle Button -->
        <Button Grid.Column="1"
                Click="OnThemeToggleClick"
                Background="#22FFFFFF"
                BorderBrush="Transparent"
                Padding="10,8"
                Margin="0"
                VerticalAlignment="Top"
                Cursor="Hand">
          <Button.Template>
            <ControlTemplate TargetType="Button">
              <Border x:Name="border"
                      Background="{TemplateBinding Background}"
                      CornerRadius="8"
                      Padding="{TemplateBinding Padding}">
                <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
              </Border>
              <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                  <Setter TargetName="border" Property="Background" Value="#44FFFFFF" />
                </Trigger>
              </ControlTemplate.Triggers>
            </ControlTemplate>
          </Button.Template>
          <StackPanel Orientation="Horizontal">
            <TextBlock x:Name="ThemeIcon" Text="ðŸŒ™" FontSize="16" Margin="0,0,6,0" />
            <ToolTipService.ToolTip>
              <ToolTip x:Name="ThemeTooltip" Content="à¸ªà¸¥à¸±à¸šà¹€à¸›à¹‡à¸™ Dark Mode" />
            </ToolTipService.ToolTip>
          </StackPanel>
        </Button>
      </Grid>
    </Border>

    <!-- Content Section -->
    <Grid x:Name="ContentArea" Grid.Row="1" Margin="24,20,24,24">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto" />
        <RowDefinition Height="*" />
        <RowDefinition Height="Auto" />
        <RowDefinition Height="Auto" />
      </Grid.RowDefinitions>

      <!-- Stats Preview Card -->
      <Border x:Name="StatsCard"
              Grid.Row="0"
              Background="#FFECFDF5"
              BorderBrush="#FF10B981"
              BorderThickness="1"
              CornerRadius="10"
              Padding="16"
              Margin="0,0,0,16">
        <Grid>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          
          <StackPanel Grid.Column="0" HorizontalAlignment="Center">
            <TextBlock x:Name="TotalElementsText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#FF059669" HorizontalAlignment="Center" Margin="0" />
            <TextBlock Text="Elements" FontSize="11" Foreground="#FF047857" HorizontalAlignment="Center" Margin="0" />
          </StackPanel>
          
          <StackPanel Grid.Column="1" HorizontalAlignment="Center">
            <TextBlock x:Name="PointCountText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#FF0EA5E9" HorizontalAlignment="Center" Margin="0" />
            <TextBlock Text="Point" FontSize="11" Foreground="#FF0369A1" HorizontalAlignment="Center" Margin="0" />
          </StackPanel>
          
          <StackPanel Grid.Column="2" HorizontalAlignment="Center">
            <TextBlock x:Name="CurveCountText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#FF8B5CF6" HorizontalAlignment="Center" Margin="0" />
            <TextBlock Text="Curve" FontSize="11" Foreground="#FF6D28D9" HorizontalAlignment="Center" Margin="0" />
          </StackPanel>
          
          <StackPanel Grid.Column="3" HorizontalAlignment="Center">
            <TextBlock x:Name="CategoryCountText" Text="0" FontSize="24" FontWeight="Bold" Foreground="#FFF59E0B" HorizontalAlignment="Center" Margin="0" />
            <TextBlock Text="Categories" FontSize="11" Foreground="#FFD97706" HorizontalAlignment="Center" Margin="0" />
          </StackPanel>
        </Grid>
      </Border>

      <!-- Main Card -->
      <Border x:Name="MainCard"
              Grid.Row="1"
              Background="{StaticResource PanelBrush}"
              BorderBrush="{StaticResource BorderBrushLight}"
              BorderThickness="1"
              CornerRadius="12"
              Padding="20">
        <Grid>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
          </Grid.RowDefinitions>
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="20" />
            <ColumnDefinition Width="260" />
          </Grid.ColumnDefinitions>

          <!-- Format Selection -->
          <StackPanel Grid.Row="0" Grid.Column="0" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
              <Path Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"
                    Fill="{StaticResource AccentBrush}"
                    Width="14" Height="14"
                    Stretch="Uniform"
                    Margin="0,0,8,0"
                    VerticalAlignment="Center" />
              <TextBlock x:Name="FormatLabel" Text="à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸Ÿà¸¥à¹Œ"
                         FontWeight="SemiBold"
                         FontSize="13"
                         VerticalAlignment="Center"
                         Margin="0" />
            </StackPanel>
            <ComboBox x:Name="FormatCombo"
                      SelectedIndex="0"
                      ToolTip="à¹€à¸¥à¸·à¸­à¸à¸£à¸¹à¸›à¹à¸šà¸šà¹„à¸Ÿà¸¥à¹Œà¸—à¸µà¹ˆà¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸ªà¹ˆà¸‡à¸­à¸­à¸">
              <ComboBoxItem Content="ðŸ“„  CSV" />
              <ComboBoxItem Content="ðŸ“‹  JSON" />
              <ComboBoxItem Content="ðŸ“Š  Excel (.xlsx)" />
            </ComboBox>
          </StackPanel>

          <!-- File Path -->
          <StackPanel Grid.Row="1" Grid.Column="0" Margin="0,8,0,0">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
              <Path Data="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"
                    Fill="{StaticResource AccentBrush}"
                    Width="14" Height="14"
                    Stretch="Uniform"
                    Margin="0,0,8,0"
                    VerticalAlignment="Center" />
              <TextBlock x:Name="FilePathLabel" Text="à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹„à¸Ÿà¸¥à¹Œ"
                         FontWeight="SemiBold"
                         FontSize="13"
                         VerticalAlignment="Center"
                         Margin="0" />
            </StackPanel>
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
              </Grid.ColumnDefinitions>
              <TextBox x:Name="FilePathBox"
                       Grid.Column="0"
                       VerticalContentAlignment="Center"
                       ToolTip="à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹„à¸Ÿà¸¥à¹Œà¸›à¸¥à¸²à¸¢à¸—à¸²à¸‡" />
              <Button Content="ðŸ“"
                      Grid.Column="1"
                      Style="{StaticResource SecondaryButton}"
                      Margin="8,4,0,12"
                      Padding="12,10"
                      ToolTip="à¹€à¸¥à¸·à¸­à¸à¸•à¸³à¹à¸«à¸™à¹ˆà¸‡à¹„à¸Ÿà¸¥à¹Œ"
                      Click="OnBrowseClick" />
            </Grid>
          </StackPanel>

          <!-- Category Filter Header -->
          <StackPanel Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Margin="0,0,0,8">
            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
              <Path Data="M3,2H21V2H21V4H20.92L15,9.92V22.91L9,16.91V9.91L3.09,4H3V2M11,16.08L13,18.08V9H13.09L18.09,4H5.92L10.92,9H11V16.08Z"
                    Fill="{StaticResource AccentBrush}"
                    Width="14" Height="14"
                    Stretch="Uniform"
                    Margin="0,0,8,0"
                    VerticalAlignment="Center" />
              <TextBlock x:Name="CategoryLabel" Text="à¸à¸£à¸­à¸‡ Category"
                         FontWeight="SemiBold"
                         FontSize="13"
                         VerticalAlignment="Center"
                         Margin="0" />
            </StackPanel>
            
            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
              <Button Content="à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”"
                      Style="{StaticResource SecondaryButton}"
                      Padding="8,4"
                      Margin="0,0,4,0"
                      FontSize="11"
                      Click="OnSelectAllClick" />
              <Button Content="à¹„à¸¡à¹ˆà¹€à¸¥à¸·à¸­à¸"
                      Style="{StaticResource SecondaryButton}"
                      Padding="8,4"
                      Margin="0"
                      FontSize="11"
                      Click="OnSelectNoneClick" />
            </StackPanel>
            
            <Border BorderBrush="{StaticResource BorderBrushLight}" 
                    BorderThickness="1" 
                    CornerRadius="8"
                    MaxHeight="260">
              <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl x:Name="CategoryList" Padding="8">
                  <ItemsControl.ItemTemplate>
                    <DataTemplate>
                      <CheckBox Content="{Binding}"
                                IsChecked="{Binding IsSelected, Mode=TwoWay}"
                                Margin="0,2"
                                FontSize="11"
                                Checked="OnCategorySelectionChanged"
                                Unchecked="OnCategorySelectionChanged" />
                    </DataTemplate>
                  </ItemsControl.ItemTemplate>
                </ItemsControl>
              </ScrollViewer>
            </Border>
            
            <TextBlock x:Name="SelectedCategoryText"
                       Text="à¹€à¸¥à¸·à¸­à¸ 0 categories"
                       FontSize="11"
                       Foreground="{StaticResource TextSecondaryBrush}"
                       Margin="0,6,0,0" />
          </StackPanel>

          <!-- Info Section -->
          <Border x:Name="InfoBox"
                  Grid.Row="3"
                  Grid.ColumnSpan="3"
                  Background="#FFF0F9FF"
                  CornerRadius="8"
                  Padding="12"
                  Margin="0,12,0,0">
            <Grid>
              <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
              </Grid.ColumnDefinitions>
              
              <Path Grid.Column="0"
                    Data="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"
                    Fill="#FF0EA5E9"
                    Width="18" Height="18"
                    Stretch="Uniform"
                    Margin="0,0,10,0"
                    VerticalAlignment="Top" />
              
              <TextBlock Grid.Column="1"
                         Foreground="#FF0369A1"
                         FontSize="12"
                         TextWrapping="Wrap"
                         Margin="0">
                <Run Text="à¸žà¸´à¸à¸±à¸”à¹à¸›à¸¥à¸‡à¹€à¸›à¹‡à¸™" FontWeight="Normal" />
                <Run Text="à¹€à¸¡à¸•à¸£" FontWeight="Bold" />
                <Run Text="à¹‚à¸”à¸¢à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´ â€¢ à¸£à¸­à¸‡à¸£à¸±à¸š Point/Curve locations â€¢ Export Id, Category, Family, Type, Level" FontWeight="Normal" />
              </TextBlock>
            </Grid>
          </Border>
        </Grid>
      </Border>

      <!-- Progress Bar -->
      <Border x:Name="ProgressPanel"
              Grid.Row="2"
              Visibility="Collapsed"
              Margin="0,16,0,0">
        <StackPanel>
          <Grid Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="*" />
              <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <TextBlock x:Name="ProgressText" Text="à¸à¸³à¸¥à¸±à¸‡ Export..." Foreground="{StaticResource TextSecondaryBrush}" FontSize="12" />
            <TextBlock x:Name="ProgressPercent" Grid.Column="1" Text="0%" Foreground="{StaticResource AccentBrush}" FontWeight="SemiBold" FontSize="12" />
          </Grid>
          <ProgressBar x:Name="ExportProgress"
                       Height="8"
                       Minimum="0"
                       Maximum="100"
                       Value="0"
                       Foreground="{StaticResource AccentBrush}"
                       Background="{StaticResource BorderBrushLight}" />
        </StackPanel>
      </Border>

      <!-- Action Buttons -->
      <Grid Grid.Row="3" Margin="0,16,0,0">
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="Auto" />
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <TextBlock Grid.Column="0"
                   Text="v1.0.0"
                   Foreground="{StaticResource TextMutedBrush}"
                   FontSize="11"
                   VerticalAlignment="Center"
                   Margin="4,0,0,0" />

        <StackPanel Grid.Column="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right">
          <Button Content="à¸¢à¸à¹€à¸¥à¸´à¸"
                  Style="{StaticResource SecondaryButton}"
                  Margin="0"
                  Click="OnCancelClick" />
          <Button x:Name="ExportButton"
                  Content="Export"
                  Style="{StaticResource SuccessButton}"
                  Margin="12,0,0,0"
                  Click="OnExportClick" />
        </StackPanel>
      </Grid>
    </Grid>
  </Grid>
</Window>
